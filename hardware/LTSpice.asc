Version 4
SHEET 1 2956 3204
WIRE 2048 576 1904 576
WIRE 1296 720 1296 688
WIRE 1392 720 1392 688
WIRE 1872 736 1872 688
WIRE 1824 768 1696 768
WIRE 2000 784 1936 784
WIRE 1824 800 1712 800
WIRE 2048 816 2048 800
WIRE 2048 816 2016 816
WIRE 1296 832 1296 800
WIRE 1392 832 1392 800
WIRE 2048 832 2048 816
WIRE 1872 864 1872 832
WIRE 1616 896 1600 896
WIRE 1712 896 1712 800
WIRE 1712 896 1696 896
WIRE 1728 896 1712 896
WIRE 1824 896 1808 896
WIRE 2048 928 2048 912
FLAG 1296 688 8V
FLAG 1296 832 0
FLAG 1872 688 8V
FLAG 1872 864 0
FLAG 2048 928 0
FLAG 1392 688 3V
FLAG 1392 832 0
FLAG 2016 816 Vfeedback
FLAG 1696 768 Vfeedback
FLAG 1824 896 0
FLAG 1904 576 Vsig
FLAG 1600 896 3V
SYMBOL MyCustom\\Op-Amp 1872 784 R0
WINDOW 3 0 0 Left 0
SYMATTR Value LM358
SYMATTR InstName U1
SYMBOL voltage 1296 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 8
SYMBOL res 2032 816 R0
SYMATTR InstName R1
SYMATTR Value 0.22
SYMBOL LED 2032 640 R0
SYMATTR InstName D1
SYMBOL nmos 2000 704 R0
SYMATTR InstName M1
SYMATTR Value AO3416
SYMBOL voltage 1392 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3
SYMBOL res 1712 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 9k
SYMBOL res 1824 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL LED 2032 576 R0
SYMATTR InstName D2
TEXT -592 -88 Left 2 !*//////////////////////////////////////////////////////////\n*LM358 DUAL OPERATIONAL AMPLIFIER MACRO-MODEL\n*//////////////////////////////////////////////////////////\n*\n* connections:      non-inverting input\n*                   |   inverting input\n*                   |   |   positive power supply\n*                   |   |   |   negative power supply\n*                   |   |   |   |   output\n*                   |   |   |   |   |\n*                   |   |   |   |   |\n.SUBCKT LM358       1   2  99  50  28\n*\n*Features:\n*Eliminates need for dual supplies\n*Large DC voltage gain =             100dB\n*High bandwidth =                     1MHz\n*Low input offset voltage =            2mV\n*Wide supply range =       +-1.5V to +-16V\n*\n*NOTE: Model is for single device only and simulated\n*      supply current is 1/2 of total device current.\n*      Output crossover distortion with dual supplies\n*      is not modeled.\n*\n****************INPUT STAGE**************\n*\nIOS 2 1 5N\n*^Input offset current\nR1 1 3 500K\nR2 3 2 500K\nI1 99 4 100U\nR3 5 50 517\nR4 6 50 517\nQ1 5 2 4 QX\nQ2 6 7 4 QX\n*Fp2=1.2 MHz\nC4 5 6 128.27P\n*\n***********COMMON MODE EFFECT***********\n*\nI2 99 50 75U\n*^Quiescent supply current\nEOS 7 1 POLY(1) 16 49 2E-3 1\n*Input offset voltage.^\nR8 99 49 60K\nR9 49 50 60K\n*\n*********OUTPUT VOLTAGE LIMITING********\nV2 99 8 1.63\nD1 9 8 DX\nD2 10 9 DX\nV3 10 50 .635\n*\n**************SECOND STAGE**************\n*\nEH 99 98 99 49 1\nG1 98 9 POLY(1) 5 6 0 9.8772E-4 0 .3459\n*Fp1=7.86 Hz\nR5 98 9 101.2433MEG\nC3 98 9 200P\n*\n***************POLE STAGE***************\n*\n*Fp=2 MHz\nG3 98 15 9 49 1E-6\nR12 98 15 1MEG\nC5 98 15 7.9577E-14\n*\n*********COMMON-MODE ZERO STAGE*********\n*\n*Fpcm=10 KHz\nG4 98 16 3 49 5.6234E-8               \nL2 98 17 15.9M\nR13 17 16 1K\n*\n**************OUTPUT STAGE**************\n*\nF6 50 99 POLY(1) V6 300U 1\nE1 99 23 99 15 1\nR16 24 23 17.5\nD5 26 24 DX\nV6 26 22 .63V\nR17 23 25 17.5\nD6 25 27 DX\nV7 22 27 .63V\nV5 22 21 0.27V\nD4 21 15 DX\nV4 20 22 0.27V\nD3 15 20 DX\nL3 22 28 500P\nRL3 22 28 100K\n*\n***************MODELS USED**************\n*\n.MODEL DX D(IS=1E-15)\n.MODEL QX PNP(BF=1.111E3)\n*\n.ENDS\n*$
TEXT 1672 992 Left 2 !.tran .01
TEXT 1544 432 Left 5 ;Current Limit
